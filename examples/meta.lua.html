<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>ML Lua API</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>ML Lua API</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>



<h2>Examples</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../examples/api_test.lua.html">api_test.lua</a></li>
  <li><a href="../examples/calc.lua.html">calc.lua</a></li>
  <li><a href="../examples/copy2m.lua.html">copy2m.lua</a></li>
  <li><a href="../examples/editor.lua.html">editor.lua</a></li>
  <li><a href="../examples/hello.lua.html">hello.lua</a></li>
  <li><a href="../examples/config.lua.html">config.lua</a></li>
  <li><a href="../examples/keys.lua.html">keys.lua</a></li>
  <li><a href="../examples/logger.lua.html">logger.lua</a></li>
  <li><a href="../examples/menutest.lua.html">menutest.lua</a></li>
  <li><strong>meta.lua</strong></li>
  <li><a href="../examples/pong.lua.html">pong.lua</a></li>
  <li><a href="../examples/recdelay.lua.html">recdelay.lua</a></li>
  <li><a href="../examples/scrnshot.lua.html">scrnshot.lua</a></li>
  <li><a href="../examples/shell.lua.html">shell.lua</a></li>
  <li><a href="../examples/sokoban.lua.html">sokoban.lua</a></li>
  <li><a href="../examples/test.lua.html">test.lua</a></li>
</ul>
<h2>Modules</h2>
<ul class="$(kind=='Topics' and '' or 'nowrap'">
  <li><a href="../modules/event.html">event</a></li>
  <li><a href="../modules/battery.html">battery</a></li>
  <li><a href="../modules/camera.html">camera</a></li>
  <li><a href="../modules/console.html">console</a></li>
  <li><a href="../modules/constants.html">constants</a></li>
  <li><a href="../modules/display.html">display</a></li>
  <li><a href="../modules/dryos.html">dryos</a></li>
  <li><a href="../modules/global.html">global</a></li>
  <li><a href="../modules/interval.html">interval</a></li>
  <li><a href="../modules/key.html">key</a></li>
  <li><a href="../modules/lens.html">lens</a></li>
  <li><a href="../modules/lv.html">lv</a></li>
  <li><a href="../modules/menu.html">menu</a></li>
  <li><a href="../modules/movie.html">movie</a></li>
  <li><a href="../modules/property.html">property</a></li>
  <li><a href="../modules/task.html">task</a></li>
  <li><a href="../modules/config.html">config</a></li>
  <li><a href="../modules/keys.html">keys</a></li>
  <li><a href="../modules/logger.html">logger</a></li>
</ul>

</div>

<div id="content">

    <h2>meta.lua</h2>
<pre>
<span class="comment">--writes custom metadata to an xmp sidecar file
</span>
<span class="global">require</span>(<span class="string">"config"</span>)

xmp_template = <span class="string">[[
&lt;x:xmpmeta xmlns:x="adobe:ns:meta/" x:xmptk="Adobe XMP Core 5.6-c011 79.156380, 2014/05/21-23:38:37        "&gt;
 &lt;rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"&gt;
  &lt;rdf:Description rdf:about=""
    xmlns:exif="http://ns.adobe.com/exif/1.0/"
    xmlns:aux="http://ns.adobe.com/exif/1.0/aux/"
   exif:ExifVersion="0230"
   exif:FNumber="%d/10"
   exif:FocalLength="%d/1"
   aux:Lens="%s"&gt;
  &lt;/rdf:Description&gt;
 &lt;/rdf:RDF&gt;
&lt;/x:xmpmeta&gt;
]]</span>

GUISTATE_QR = <span class="number">3</span>

<span class="keyword">function</span> get_sidecar_filename()
    <span class="keyword">return</span> <span class="global">string</span>.format(<span class="string">"DCIM/%03dCANON/%s%04d.XMP"</span>, dryos.shooting_card.folder_number, dryos.prefix, dryos.shooting_card.file_number)
<span class="keyword">end</span>

<span class="keyword">function</span> write_xmp(fnumber, fl, lens)
    <span class="keyword">local</span> f = <span class="global">io</span>.open(get_sidecar_filename(), <span class="string">"w+"</span>)
    f:write(<span class="global">string</span>.format(xmp_template,fnumber,fl,lens))
    f:close()
<span class="keyword">end</span>

<span class="keyword">function</span> property.GUI_STATE:handler(value)
    <span class="keyword">if</span> value == GUISTATE_QR <span class="keyword">then</span>
        write_xmp(meta_menu.submenu.Aperture.value, meta_menu.submenu[<span class="string">"Focal Length"</span>].value,<span class="string">"MANUAL LENS"</span>)
    <span class="keyword">end</span>
<span class="keyword">end</span>

meta_menu = menu.new
{
    parent = <span class="string">"Shoot"</span>,
    name = <span class="string">"Metadata"</span>,
    help = <span class="string">"Custom metadata for non-chipped lenses"</span>,
    submenu =
    {
        {
            name = <span class="string">"Aperture"</span>,
            help = <span class="string">"Manually enter the Aperture"</span>,
            min = <span class="number">10</span>,
            max = <span class="number">280</span>,
            value = <span class="number">40</span>,
            update = <span class="keyword">function</span>(self)
                <span class="keyword">return</span> <span class="global">string</span>.format(<span class="string">"f/%d.%d"</span>, self.value // <span class="number">10</span>, self.value % <span class="number">10</span>)
            <span class="keyword">end</span>
        },
        {
            name = <span class="string">"Focal Length"</span>,
            help = <span class="string">"Manually enter the Focal Length"</span>,
            min = <span class="number">10</span>,
            max = <span class="number">300</span>,
            value = <span class="number">50</span>,
        }
    }
}

config.create_from_menu(meta_menu)</pre>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.3</a></i>
<i style="float:right;">Last updated 2016-03-21 21:07:57 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
